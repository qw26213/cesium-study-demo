<!doctype html>
<html>

<head>
    <title>Cesium007-entity</title>
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="../Build/Cesium/Widgets/widgets.css">
    <script type="text/javascript" src="../Build/Cesium/Cesium.js"></script>
    <style>
        div,
        body {
            padding: 0;
            margin: 0;
        }

        .cesium-widget-credits {
            display: none !important;
        }
    </style>

<body>
    <div id="cesiumcontainer" style="width:100%;height:100%"></div>

    <script type="text/javascript">
        var viewer = new Cesium.Viewer("cesiumcontainer", {
            //搜索框
            geocoder: false,
            //home键
            homeButton: false,
            // 动画控件
            animation: false,
            //全屏按钮
            fullscreenButton: false,
            //场景模式选择器
            sceneModePicker: false,
            //时间轴
            timeline: false,
            //导航提示
            navigationHelpButton: false,
            //地图选择器
            baseLayerPicker: false,
            imageryProvider: new Cesium.UrlTemplateImageryProvider({
                url: "http://webrd01.is.autonavi.com/appmaptile?&scale=1&lang=zh_cn&style=8&x={x}&y={y}&z={z}",
                minimumLevel: 1,
                maximumLevel: 18
            }),
        })
       

        window.setInterval(function(){ viewer.terrainProvider = Cesium.createWorldTerrain();
        var positions = Cesium.Cartesian3.fromDegreesArray([114.22268842439114, 38.134979272096594,
            114.5199580178976, 38.1139391070047,
            114.24207825088216, 37.91371829614106,
            114.56477609722275, 37.908966850537524])
        console.log(positions);
        Cesium.sampleTerrainMostDetailed(viewer.terrainProvider, positions).then(updatapositions => {
            console.log(updatapositions);
            const cartesianPositions = Cesium.Ellipsoid.WGS84.cartesianArrayToCartographicArray(updatapositions);
            console.log(cartesianPositions);
        })},10000)
        //  console.log(Cesium.Cartographic);

        var handler = new Cesium.ScreenSpaceEventHandler(viewer.scene.canvas);
        handler.setInputAction(function (movement) {
            var ray = this.viewer.camera.getPickRay(movement.position);
            if (!ray) return null;
            var position = this.viewer.scene.globe.pick(ray, this.viewer.scene);
            console.log(movement.position);
            console.log(position);
            var cartographic = Cesium.Ellipsoid.WGS84.cartesianToCartographic(position);
            console.log(cartographic);
            var lon = Cesium.Math.toDegrees(cartographic.longitude);
            var lat = Cesium.Math.toDegrees(cartographic.latitude);
            console.log(lon, lat);
        }, Cesium.ScreenSpaceEventType.LEFT_CLICK);
        //创建DataSource
        var datasource = new Cesium.CustomDataSource("enetiestestdata");
        viewer.dataSources.add(datasource)
        let element = datasource.entities.add({
            position: Cesium.Cartesian3.fromDegrees(108, 34, 10),
            billboard: {
                image: "./images/1.png",
                scale: 0.5,
                // sizeInMeters:true,
                horizontalOrigin: Cesium.HorizontalOrigin.CENTER,
                verticalOrigin: Cesium.VerticalOrigin.BOTTOM,
                //pixelOffset:new Cesium.Cartesian2(0,20),
                //alignedAxis: Cesium.Cartesian3.UNIT_Y,
                // rotation:-1.57,
                // scaleByDistance: new Cesium.NearFarScalar(20000, 1, 8000000, 0.1),
                ////pixelOffsetScaleByDistance: new Cesium.NearFarScalar(20000, 10, 8000000, 100),
                //translucencyByDistance : new Cesium.NearFarScalar(20000, 1, 8000000, 0),
                //distanceDisplayCondition: new Cesium.DistanceDisplayCondition(2000, 800000),

            },
            label: {
                text: "label1",
                scale: 1,
                style: Cesium.LabelStyle.FILL_AND_OUTLINE,
                fillColor: Cesium.Color.BLUE,
                outlineColor: Cesium.Color.RED,
                showBackground: false,
                pixelOffset: new Cesium.Cartesian2(0, -180),
                backgroundColor: Cesium.Color.BLACK,
                eyeOffset: new Cesium.Cartesian3(0, 0, -10)
            },
            point: {
                pixelSize: 50,
                color: Cesium.Color.RED
            }
        })

        viewer.camera.setView({
            destination: Cesium.Cartesian3.fromDegrees(109, 34, 1000000),	//相机（眼睛）位置  不是地图位置
            //相机的姿态
            orientation: {
                heading: Cesium.Math.toRadians(0.0), // 朝向
                pitch: Cesium.Math.toRadians(-90),    // 俯仰
                roll: 0.0                            //滚转                       
            },
            duration: 5
        });

    </script>
</body>

</html>