<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>cesium第二课</title>
    <script src="Build/CesiumUnminified/Cesium.js"></script>
    <link rel="stylesheet" href="Build/Cesium/Widgets/widgets.css">
    <style>
        html,
        body {
            padding: 0px;
            margin: 0px;
        }
        #cesiumContainer{
            width: 100%;
            height: 100%;
        }
    </style>
</head>

<body>
<div id="cesiumContainer"></div>
<script>
var imageryProvider = new Cesium.UrlTemplateImageryProvider({url: 'https://t0.tianditu.gov.cn/DataServer?T=img_w&tk=f398daef89049d918105f6d4d412916a&x={x}&y={y}&l={z}'});
var viewer = new Cesium.Viewer('cesiumContainer', {
    animation : false,//是否创建动画小器件，左下角仪表
    baseLayerPicker : false,//是否显示图层选择器
    fullscreenButton : false,//是否显示全屏按钮
    geocoder : false,//是否显示geocoder小器件，右上角查询按钮
    homeButton : false,//是否显示Home按钮
    infoBox : false,//是否显示信息框
    sceneModePicker : false,//是否显示3D/2D选择器
    scene3DOnly : false,//如果设置为true，则所有几何图形以3D模式绘制以节约GPU资源
    selectionIndicator : false,//是否显示选取指示器组件
    timeline : false,//是否显示时间轴
    navigationHelpButton : false,//是否显示右上角的帮助按钮
    baselLayerPicker:false,// 将图层选择的控件关掉，才能添加其他影像数据
    shadows: true,//是否显示背影
    shouldAnimate: true,
    // sceneMode: 2,
    imageryProvider,
});
var czml = [{
    "id": "document",
    "name":"CZML Path",
    "version": "1.0",
    "clock": {
        "interval": "2012-08-04T10:00:00Z/2012-08-04T15:00:00Z",
        "currentTime": "2012-08-04T10:00:00Z",
        "multiplier": 10
    }
}, {
    "id": "path",
    "name": "path with GPS flight data",
    "description": "<p>Hang gliding flight log data from Daniel H. Friedman.<br>Icon created by Larisa Skosyrska from the Noun Project</p>",
    "availability": "2012-08-04T10:00:00Z/2012-08-04T15:00:00Z",
    "path": {
        "material": {
            "polylineOutline": {
                "color": {
                    "rgba": [255, 0, 255, 255]
                },
                "outlineColor": {
                    "rgba": [0, 255, 255, 255]
                },
                "outlineWidth": 5
            }
        },
        "width": 8,
        "leadTime": 0, // 路线提前执行时间
        "trailTime": 100000, // 路线跟踪时间
        "resolution": 5,
        //"arcType" : "RHUMB",
    },
    "ellipse": { // 椭圆
        "semiMinorAxis": 10.0, // 椭圆大小
        "semiMajorAxis": 20.0,
        "height": 0,
        "material": {
            "solidColor": {
                "color": {
                    "rgba": [255, 0, 0, 127]
                }
            }
        },
        "outline": true, // height must be set for outlines to display
        "outlineColor": { // 边框颜色
            "rgba": [255, 255, 255, 255]
        }
    },
    "position": {
        "epoch": "2012-08-04T10:00:00Z",
        "cartographicDegrees": [
            0.0, 118.87841653400005, 30.956798, 0.0,
            10.0, 118.87826541800007, 30.956799, 0.0,
 
        ]
    }
}];
 
Cesium.Ion.defaultAccessToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJiYjM4NjkxNi04Nzc0LTQ1ODYtYjFmMC0yOTQyZjNmYzIyYmMiLCJpZCI6MTQ5OTQsInNjb3BlcyI6WyJhc3IiLCJnYyJdLCJpYXQiOjE1NjY4NzE1Mjl9.LH4ubGV8dmhYDByXr33yhHpKApkL2k6cTzkOSqEqtRc';
viewer.dataSources.add(Cesium.CzmlDataSource.load(czml)).then(function (ds) {
    viewer.trackedEntity = ds.entities.getById('path');//追踪实体
});
 
// 动态赋值
var i = 30.956800;
var a = 20;
var b=118.8774481050001;
setInterval(function() {
    i += 0.001*Math.random();
    b+=0.001*Math.random();
    a += 10;
    //路径最后添加节点
    czml[1].position.cartographicDegrees.push(a, b, i, 0);// 赋值当前最新行驶路线
    czml[0].clock.currentTime = viewer.clock.currentTime.toString(); // 修改当前时间，防止从头重新开始执行
    //清空之前数据，否则数据越来越多
    viewer.entities.removeAll();
    //重新添加修改后的数据
    viewer.dataSources.add(Cesium.CzmlDataSource.load(czml));
}, 1000);
</script>